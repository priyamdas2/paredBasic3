% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/main_FLasso.R
\name{pared_FLasso}
\alias{pared_FLasso}
\title{GP-Based Pareto Front for Fused Lasso}
\usage{
pared_FLasso(
  X,
  y,
  lb = c(-3, -3),
  ub = c(1, 1),
  Pareto_budget = 100,
  plot_title = "Fused LASSO",
  plot_marker_color = "rgba(255, 0, 0, 0.7)",
  plot_marker_border_color = "black",
  plot_marker_size = 10,
  plot_marker_border_width = 2,
  plot_marker_symbol = "circle",
  fontsize_x = 20,
  fontsize_y = 20,
  fontsize_z = 20,
  plot_title_size = 40,
  title_pos_x = 0.5,
  title_pos_y = 0.95,
  draw_projection = 1,
  proj_line_color = "black",
  proj_line_width = 2,
  proj_marker_size = 2,
  proj_marker_color = "rgba(255, 0, 0, 0.7)",
  proj_marker_border_width = 2,
  proj_marker_border_color = "black"
)
}
\arguments{
\item{X}{A numeric matrix of predictor variables (n x p), where n is the number
of samples and p is the number of predictors.}

\item{y}{A numeric vector of length n representing the response variable.}

\item{lb}{A numeric vector specifying the lower bounds (log10-scale) for \eqn{\lambda_1} and \eqn{\lambda_2}. Default is c(-3, -3).}

\item{ub}{A numeric vector specifying the upper bounds (log10-scale) for \eqn{\lambda_1} and \eqn{\lambda_2}. Default is c(1, 1).}

\item{Pareto_budget}{Number of evaluations in the GP-based Pareto optimization. Default is 100.}

\item{plot_title}{A character string for the title of the plot. Default is "Fused LASSO".}

\item{plot_marker_color}{Fill color of markers. Default is red with transparency.}

\item{plot_marker_border_color}{Border color of markers. Default is black.}

\item{plot_marker_size}{Size of Pareto front markers. Default value is 10.}

\item{plot_marker_border_width}{Width of marker borders. Default value is 2.}

\item{plot_marker_symbol}{Symbol shape for plot markers (e.g., 'circle', 'square', 'diamond'). Default shape is 'circle'.}

\item{fontsize_x}{Font size of the x-axis title. Default value is 20.}

\item{fontsize_y}{Font size of the y-axis title. Default value is 20.}

\item{fontsize_z}{Font size of the z-axis title. Default value is 20.}

\item{plot_title_size}{Font size for the plot title. Default value is 40.}

\item{title_pos_x}{Horizontal position of the title (0 to 1 scale). Default is 0.5.}

\item{title_pos_y}{Vertical position of the title (0 to 1 scale). Default is 0.95.}

\item{draw_projection}{Logical flag (0 or 1) to add projections from each point to the XY plane. Default is 1.}

\item{proj_line_color}{Color for projection lines. Default is black.}

\item{proj_line_width}{Width of projection lines. Default value is 2.}

\item{proj_marker_size}{Size of projection plane markers. Default value is 2.}

\item{proj_marker_color}{Fill color of projection markers. Default is red with transparency.}

\item{proj_marker_border_width}{Border width of projection markers. Default value is 2.}

\item{proj_marker_border_color}{Border color of projection markers. Default is black.}
}
\value{
A list with two componenets:
\itemize{
\item \code{figure}: A \code{plotly} 3D scatter plot object showing the Pareto front.
\item \code{summary_table}: A data frame containing the summary of the Pareto
optimal solutions, including the values for \eqn{\lambda_1}, \eqn{\lambda_2},
number of non-zero coefficients, RSS, and roughness.
}
}
\description{
This function performs a Pareto optimality search on the Fused Lasso problem
using GP-based optimization (\code{easyGParetoptim}) and creates a 3D scatter plot
of the solution space. The plot displays the number of non-zero coefficients,
residual sum of squares (RSS), and roughness (mean absolute difference of consecutive beta coefficients) for different Pareto-optimal combinations
of the regularization parameters \eqn{\lambda_1} and \eqn{\lambda_2}.
}
\details{
The Fused Lasso objective function used is:
\deqn{
\mathcal{L}(\beta) = \frac{1}{2n} \|y - X\beta\|_2^2 + \lambda_1 \|\beta\|_1 + \lambda_2 \sum_{j=2}^{p} |\beta_j - \beta_{j-1}|
}
where \eqn{X} is the design matrix, \eqn{y} is the response vector,
\eqn{\beta} is the coefficient vector, \eqn{\lambda_1 > 0} controls the sparsity of \eqn{\beta},
and \eqn{\lambda_2 > 0} encourages smoothness between adjacent coefficients.
The function fits Fused Lasso and uses \code{easyGParetoptim} for Pareto optimization.
Each point in the plot corresponds to a model, where:
\itemize{
\item x-axis: Number of non-zero coefficients (sparsity).
\item y-axis: Residual sum of squares (RSS).
\item z-axis: Roughness, i.e., mean absolute difference of consecutive beta coefficients.
}
The lower these three quantities, the better the model according to their respective criteria.
}
\examples{
\dontrun{
# Example data
set.seed(123)
n <- 100
p <- 10
X <- matrix(rnorm(n * p), nrow = n, ncol = p)
beta_true <- c(0, 0, 1, 1, 1, 0, 0, 0, 2, 2)
y <- X \%*\% beta_true + rnorm(n)

# Run the function and plot
result <- pared_FLasso(X, y, Pareto_budget = 80, plot_marker_symbol = 'diamond', plot_marker_size = 7)
result$figure
result$summary_table
}

}
